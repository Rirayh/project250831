08/30 05:01:12 - OpenCompass - INFO - Task [pard-qwen2.5-7b/demo_gsm8k]
08/30 05:01:16 - OpenCompass - INFO - Initializing PardDreamEngine...
08/30 05:01:17 - OpenCompass - INFO - Loading target model: Qwen/Qwen2.5-7B-Instruct
Sliding Window Attention is enabled but not implemented for `sdpa`; unexpected results may be encountered.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  4.28it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  5.13it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.15it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  5.75it/s]
08/30 05:01:22 - OpenCompass - INFO - Loading draft model: Dream-org/Dream-v0-Instruct-7B
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  3.98it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  4.89it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  5.71it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  5.36it/s]
/net/scratch2/zhaorun/zichen/junlong/conda_envs/fdllm/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:629: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.
  warnings.warn(
/net/scratch2/zhaorun/zichen/junlong/conda_envs/fdllm/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:629: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
08/30 05:01:27 - OpenCompass - INFO - PardDreamEngine initialized successfully.
08/30 05:01:31 - OpenCompass - INFO - Try to load the data from /home/zhaorun/.cache/opencompass/./data/gsm8k/
Map:   0%|          | 0/7473 [00:00<?, ? examples/s]Map:  30%|███       | 2256/7473 [00:00<00:00, 22368.83 examples/s]Map:  61%|██████    | 4554/7473 [00:00<00:00, 22714.08 examples/s]Map:  92%|█████████▏| 6896/7473 [00:00<00:00, 22980.12 examples/s]Map: 100%|██████████| 7473/7473 [00:00<00:00, 22411.60 examples/s]
Map:   0%|          | 0/1319 [00:00<?, ? examples/s]Map: 100%|██████████| 1319/1319 [00:00<00:00, 21413.26 examples/s]
08/30 05:01:31 - OpenCompass - INFO - Start inferencing [pard-qwen2.5-7b/demo_gsm8k]
Traceback (most recent call last):
  File "/net/scratch2/zhaorun/zichen/junlong/projects/pard_eval_on_opencompass/opencompass/tasks/openicl_infer.py", line 161, in <module>
    inferencer.run()
  File "/net/scratch2/zhaorun/zichen/junlong/projects/pard_eval_on_opencompass/opencompass/tasks/openicl_infer.py", line 89, in run
    self._inference()
  File "/net/scratch2/zhaorun/zichen/junlong/projects/pard_eval_on_opencompass/opencompass/tasks/openicl_infer.py", line 134, in _inference
    inferencer.inference(retriever,
  File "/net/scratch2/zhaorun/zichen/junlong/projects/pard_eval_on_opencompass/opencompass/openicl/icl_inferencer/icl_gen_inferencer.py", line 100, in inference
    prompt_list = self.get_generation_prompt_list_from_retriever_indices(
  File "/net/scratch2/zhaorun/zichen/junlong/projects/pard_eval_on_opencompass/opencompass/openicl/icl_inferencer/icl_gen_inferencer.py", line 223, in get_generation_prompt_list_from_retriever_indices
    prompt_token_num = self.model.get_token_len_from_template(
  File "/net/scratch2/zhaorun/zichen/junlong/projects/pard_eval_on_opencompass/opencompass/models/base.py", line 218, in get_token_len_from_template
    prompts = self.parse_template(templates, mode=mode)
  File "/net/scratch2/zhaorun/zichen/junlong/projects/pard_eval_on_opencompass/opencompass/models/base.py", line 161, in parse_template
    return self.template_parser.parse_template(prompt_template, mode)
AttributeError: 'PardDreamModel' object has no attribute 'template_parser'
